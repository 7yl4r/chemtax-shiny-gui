---
title: "Quarto Basics"
format:
  html:
    code-fold: true
params:
  pigments_df_file: "../sample_data/sm.csv"
---
```{R}
#|label: helper functions

# Helper functions ----
get_df_from_file <- function(filepath){
  # function to read the taxalist & pigment csv files.
  tryCatch({
    # when reading semicolon separated files,
    # having a comma separator causes `read.csv` to error
      df <- read.csv(filepath,
                     header = TRUE,
                     sep = ',',
                     quote = '"')
    },
    error = function(e) {
      # return a safeError if a parsing error occurs
      print(e)
    }
  )
  return(df)
}

```

```{R}
#| label: load data
tryCatch({
  
  pigment_df <- get_df_from_file(params$pigments_df_file)
  # TODO: validate
  
  # Update the status based on the length of the data frame
  if (nrow(pigment_df) > 0) {
    print(paste("Data loaded, length:", nrow(pigment_df)))
  } else {
    print("Data loaded, but the data frame is empty")
  }
}, error = function(e){print(e)})

```

```{R}
#|label: clustering
tryCatch({
result <- phytoclass::Cluster(
  pigment_df,
  14  # min_cluster_size
)
# print(result$cluster.list)
# plot of clusters
plot(result$cluster.plot)
}, error = function(e){print(e)})

```
